<!DOCTYPE html>
<html>

<head>
    <title>Cloud-ALI AI Dashboard</title>
    <style>
        body {
            font-family: Arial;
            margin: 20px;
            background: #f4f6f8;
        }

        .card {
            background: white;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 6px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .high {
            color: red;
        }

        .medium {
            color: orange;
        }

        .low {
            color: green;
        }

        pre {
            background: #eee;
            padding: 10px;
            white-space: pre-wrap;
        }
    </style>
</head>

<body>
    <h1>ðŸš¨ Cloud-ALI AI Live Incidents</h1>

    <div id="incidents"></div>

    <script>
        async function loadIncidents() {
            const res = await fetch("http://localhost:8000/incidents");
            const data = await res.json();

            const container = document.getElementById("incidents");
            container.innerHTML = "";

            data.forEach(i => {
                const div = document.createElement("div");
                div.className = "card";

                div.innerHTML = `
      <h3>${i.resource}</h3>
      <b>Severity:</b> ${i.severity}<br>
      <b>Confidence:</b> <span class="${i.ai_confidence}">
        ${i.ai_confidence}
      </span><br>
      <b>Root Cause:</b> ${i.ai_root_cause || "N/A"}<br>
      <b>Received:</b> ${i.received_at}<br><br>

      <b>LLM Analysis:</b>
      <pre>${i.llm_analysis || "Not available"}</pre>
    `;
                container.appendChild(div);
            });
        }

        // refresh every 10 seconds
        loadIncidents();
        setInterval(loadIncidents, 10000);
    </script>
</body>

</html>